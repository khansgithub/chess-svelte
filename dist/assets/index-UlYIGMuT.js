var Ln=Object.defineProperty;var br=t=>{throw TypeError(t)};var On=(t,e,r)=>e in t?Ln(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var d=(t,e,r)=>On(t,typeof e!="symbol"?e+"":e,r),xe=(t,e,r)=>e.has(t)||br("Cannot "+r);var p=(t,e,r)=>(xe(t,e,"read from private field"),r?r.call(t):e.get(t)),L=(t,e,r)=>e.has(t)?br("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),j=(t,e,r,n)=>(xe(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),xt=(t,e,r)=>(xe(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();const kr=!1;var Ye=Array.isArray,xn=Array.prototype.indexOf,Xe=Array.from,$e=Object.defineProperty,qt=Object.getOwnPropertyDescriptor,Hr=Object.getOwnPropertyDescriptors,Dn=Object.prototype,Pn=Array.prototype,Ze=Object.getPrototypeOf,Ar=Object.isExtensible;function Cn(t){return t()}function Ue(t){for(var e=0;e<t.length;e++)t[e]()}function qn(){var t,e,r=new Promise((n,s)=>{t=n,e=s});return{promise:r,resolve:t,reject:e}}const F=2,Kr=4,ze=8,te=16,tt=32,Nt=64,Br=128,K=256,ue=512,x=1024,B=2048,dt=4096,W=8192,It=16384,Je=32768,tr=65536,Tr=1<<17,Mn=1<<18,er=1<<19,rr=1<<20,He=1<<21,nr=1<<22,_t=1<<23,Mt=Symbol("$state"),$n=Symbol(""),sr=new class extends Error{constructor(){super(...arguments);d(this,"name","StaleReactionError");d(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Un(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function Hn(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Kn(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Bn(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Fn(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function jn(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Gn(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Vn(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Wn(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Qn(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const Te=1,Se=2,Fr=4,Yn=8,Xn=16,Zn=2,D=Symbol(),zn="http://www.w3.org/1999/xhtml";let Jn=!1;function jr(t){return t===this.v}function ts(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Gr(t){return!ts(t,this.v)}let ee=!1,es=!1;function rs(){ee=!0}let R=null;function fe(t){R=t}function Vr(t,e=!1,r){R={p:R,c:null,e:null,s:t,x:null,l:ee&&!e?{s:null,u:null,$:[]}:null}}function Wr(t){var e=R,r=e.e;if(r!==null){e.e=null;for(var n of r)ln(n)}return R=e.p,{}}function re(){return!ee||R!==null&&R.l===null}const ns=new WeakMap;function ss(t){var e=y;if(e===null)return w.f|=_t,t;if((e.f&Je)===0){if((e.f&Br)===0)throw!e.parent&&t instanceof Error&&Qr(t),t;e.b.error(t)}else ir(t,e)}function ir(t,e){for(;e!==null;){if((e.f&Br)!==0)try{e.b.error(t);return}catch{}e=e.parent}throw t instanceof Error&&Qr(t),t}function Qr(t){const e=ns.get(t);e&&($e(t,"message",{value:e.message}),$e(t,"stack",{value:e.stack}))}let ce=[];function is(){var t=ce;ce=[],Ue(t)}function Yr(t){ce.length===0&&queueMicrotask(is),ce.push(t)}function as(){for(var t=y.b;t!==null&&!t.has_pending_snippet();)t=t.parent;return t===null&&Un(),t}function ar(t){var e=F|B,r=w!==null&&(w.f&F)!==0?w:null;return y===null||r!==null&&(r.f&K)!==0?e|=K:y.f|=er,{ctx:R,deps:null,effects:null,equals:jr,f:e,fn:t,reactions:null,rv:0,v:D,wv:0,parent:r??y,ac:null}}function os(t,e){let r=y;r===null&&Kn();var n=r.b,s=void 0,i=Kt(D),a=null,l=!w;return Es(()=>{try{var o=t()}catch(_){o=Promise.reject(_)}var u=()=>o;s=(a==null?void 0:a.then(u,u))??Promise.resolve(o),a=s;var f=H,v=n.pending;l&&(n.update_pending_count(1),v||f.increment());const h=(_,c=void 0)=>{a=null,v||f.activate(),c?c!==sr&&(i.f|=_t,Bt(i,c)):((i.f&_t)!==0&&(i.f^=_t),Bt(i,_)),l&&(n.update_pending_count(-1),v||f.decrement()),zr()};if(s.then(h,_=>h(null,_||"unknown")),f)return()=>{queueMicrotask(()=>f.neuter())}}),new Promise(o=>{function u(f){function v(){f===s?o(i):u(s)}f.then(v,v)}u(s)})}function _e(t){const e=ar(t);return e.equals=Gr,e}function Xr(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)z(e[r])}}function ls(t){for(var e=t.parent;e!==null;){if((e.f&F)===0)return e;e=e.parent}return null}function or(t){var e,r=y;ot(ls(t));try{Xr(t),e=gn(t)}finally{ot(r)}return e}function Zr(t){var e=or(t);if(t.equals(e)||(t.v=e,t.wv=dn()),!Rt)if(st!==null)st.set(t,t.v);else{var r=(it||(t.f&K)!==0)&&t.deps!==null?dt:x;P(t,r)}}function us(t,e,r){const n=re()?ar:_e;if(e.length===0){r(t.map(n));return}var s=H,i=y,a=fs(),l=as();Promise.all(e.map(o=>os(o))).then(o=>{s==null||s.activate(),a();try{r([...t.map(n),...o])}catch(u){(i.f&It)===0&&ir(u,i)}s==null||s.deactivate(),zr()}).catch(o=>{l.error(o)})}function fs(){var t=y,e=w,r=R;return function(){ot(t),X(e),fe(r)}}function zr(){ot(null),X(null),fe(null)}const oe=new Set;let H=null,st=null;let Pt=[],ve=null,Ke=!1;var Gt,At,Tt,rt,Vt,Wt,ft,St,nt,Z,ct,J,Jr,tn,Be;const dr=class dr{constructor(){L(this,J);L(this,Gt,new Map);L(this,At,new Map);L(this,Tt,new Set);L(this,rt,0);L(this,Vt,null);L(this,Wt,!1);L(this,ft,[]);L(this,St,[]);L(this,nt,[]);L(this,Z,[]);L(this,ct,[]);d(this,"skipped_effects",new Set)}capture(e,r){p(this,At).has(e)||p(this,At).set(e,r),p(this,Gt).set(e,e.v)}activate(){H=this}deactivate(){H=null}neuter(){j(this,Wt,!0)}flush(){Pt.length>0?this.flush_effects():xt(this,J,Be).call(this),H===this&&(p(this,rt)===0&&oe.delete(this),H=null)}flush_effects(){var e=yt;Ke=!0;try{var r=0;for(Ir(!0);Pt.length>0;)r++>1e3&&cs(),xt(this,J,Jr).call(this,Pt),vt.clear()}finally{Ke=!1,Ir(e),ve=null}}increment(){j(this,rt,p(this,rt)+1)}decrement(){if(j(this,rt,p(this,rt)-1),p(this,rt)===0){for(const e of p(this,nt))P(e,B),at(e);for(const e of p(this,Z))P(e,B),at(e);for(const e of p(this,ct))P(e,B),at(e);j(this,nt,[]),j(this,Z,[]),this.flush()}}add_callback(e){p(this,Tt).add(e)}settled(){return(p(this,Vt)??j(this,Vt,qn())).promise}static ensure(){if(H===null){const e=H=new dr;oe.add(H),queueMicrotask(()=>{H===e&&e.flush()})}return H}};Gt=new WeakMap,At=new WeakMap,Tt=new WeakMap,rt=new WeakMap,Vt=new WeakMap,Wt=new WeakMap,ft=new WeakMap,St=new WeakMap,nt=new WeakMap,Z=new WeakMap,ct=new WeakMap,J=new WeakSet,Jr=function(e){var i;Pt=[];var r=null;if(oe.size>1){r=new Map,st=new Map;for(const[a,l]of p(this,Gt))r.set(a,{v:a.v,wv:a.wv}),a.v=l;for(const a of oe)if(a!==this)for(const[l,o]of p(a,At))r.has(l)||(r.set(l,{v:l.v,wv:l.wv}),l.v=o)}for(const a of e)xt(this,J,tn).call(this,a);if(p(this,ft).length===0&&p(this,rt)===0){var n=p(this,nt),s=p(this,Z);j(this,nt,[]),j(this,Z,[]),j(this,ct,[]),xt(this,J,Be).call(this),Sr(n),Sr(s),(i=p(this,Vt))==null||i.resolve()}else{for(const a of p(this,nt))P(a,x);for(const a of p(this,Z))P(a,x);for(const a of p(this,ct))P(a,x)}if(r){for(const[a,{v:l,wv:o}]of r)a.wv<=o&&(a.v=l);st=null}for(const a of p(this,ft))Ut(a);for(const a of p(this,St))Ut(a);j(this,ft,[]),j(this,St,[])},tn=function(e){var f;e.f^=x;for(var r=e.first;r!==null;){var n=r.f,s=(n&(tt|Nt))!==0,i=s&&(n&x)!==0,a=i||(n&W)!==0||this.skipped_effects.has(r);if(!a&&r.fn!==null){if(s)r.f^=x;else if((n&Kr)!==0)p(this,Z).push(r);else if(Ie(r))if((n&nr)!==0){var l=(f=r.b)!=null&&f.pending?p(this,St):p(this,ft);l.push(r)}else(r.f&te)!==0&&p(this,ct).push(r),Ut(r);var o=r.first;if(o!==null){r=o;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)r=u.next,u=u.parent}},Be=function(){if(!p(this,Wt))for(const e of p(this,Tt))e();p(this,Tt).clear()};let he=dr;function cs(){try{Gn()}catch(t){if(ve!==null)ir(t,ve);else throw t}}function Sr(t){var e=t.length;if(e!==0){for(var r=0;r<e;r++){var n=t[r];if((n.f&(It|W))===0&&Ie(n)){var s=de;if(Ut(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null?_n(n):n.fn=null),de>s&&(n.f&rr)!==0)break}}for(;r<e;r+=1)at(t[r])}}function at(t){for(var e=ve=t;e.parent!==null;){e=e.parent;var r=e.f;if(Ke&&e===y&&(r&te)!==0)return;if((r&(Nt|tt))!==0){if((r&x)===0)return;e.f^=x}}Pt.push(e)}const vt=new Map;function Kt(t,e){var r={f:0,v:t,reactions:null,equals:jr,rv:0,wv:0};return r}function M(t,e){const r=Kt(t);return As(r),r}function _s(t,e=!1,r=!0){var s;const n=Kt(t);return e||(n.equals=Gr),ee&&r&&R!==null&&R.l!==null&&((s=R.l).s??(s.s=[])).push(n),n}function $(t,e,r=!1){w!==null&&(!Y||(w.f&Tr)!==0)&&re()&&(w.f&(F|te|nr|Tr))!==0&&!(q!=null&&q.includes(t))&&Qn();let n=r?wt(e):e;return Bt(t,n)}function Bt(t,e){if(!t.equals(e)){var r=t.v;Rt?vt.set(t,e):vt.set(t,r),t.v=e,he.ensure().capture(t,r),(t.f&F)!==0&&((t.f&B)!==0&&or(t),P(t,(t.f&K)===0?x:dt)),t.wv=dn(),en(t,B),re()&&y!==null&&(y.f&x)!==0&&(y.f&(tt|Nt))===0&&(G===null?Ts([t]):G.push(t))}return e}function De(t){$(t,t.v+1)}function en(t,e){var r=t.reactions;if(r!==null)for(var n=re(),s=r.length,i=0;i<s;i++){var a=r[i],l=a.f;(l&B)===0&&(!n&&a===y||(P(a,e),(l&(x|K))!==0&&((l&F)!==0?en(a,dt):at(a))))}}function wt(t){if(typeof t!="object"||t===null||Mt in t)return t;const e=Ze(t);if(e!==Dn&&e!==Pn)return t;var r=new Map,n=Ye(t),s=M(0),i=ht,a=l=>{if(ht===i)return l();var o=w,u=ht;X(null),Lr(i);var f=l();return X(o),Lr(u),f};return n&&r.set("length",M(t.length)),new Proxy(t,{defineProperty(l,o,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&Vn();var f=r.get(o);return f===void 0?f=a(()=>{var v=M(u.value);return r.set(o,v),v}):$(f,u.value,!0),!0},deleteProperty(l,o){var u=r.get(o);if(u===void 0){if(o in l){const h=a(()=>M(D));r.set(o,h),De(s)}}else{if(n&&typeof o=="string"){var f=r.get("length"),v=Number(o);Number.isInteger(v)&&v<f.v&&$(f,v)}$(u,D),De(s)}return!0},get(l,o,u){var _;if(o===Mt)return t;var f=r.get(o),v=o in l;if(f===void 0&&(!v||(_=qt(l,o))!=null&&_.writable)&&(f=a(()=>{var c=wt(v?l[o]:D),g=M(c);return g}),r.set(o,f)),f!==void 0){var h=I(f);return h===D?void 0:h}return Reflect.get(l,o,u)},getOwnPropertyDescriptor(l,o){var u=Reflect.getOwnPropertyDescriptor(l,o);if(u&&"value"in u){var f=r.get(o);f&&(u.value=I(f))}else if(u===void 0){var v=r.get(o),h=v==null?void 0:v.v;if(v!==void 0&&h!==D)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return u},has(l,o){var h;if(o===Mt)return!0;var u=r.get(o),f=u!==void 0&&u.v!==D||Reflect.has(l,o);if(u!==void 0||y!==null&&(!f||(h=qt(l,o))!=null&&h.writable)){u===void 0&&(u=a(()=>{var _=f?wt(l[o]):D,c=M(_);return c}),r.set(o,u));var v=I(u);if(v===D)return!1}return f},set(l,o,u,f){var A;var v=r.get(o),h=o in l;if(n&&o==="length")for(var _=u;_<v.v;_+=1){var c=r.get(_+"");c!==void 0?$(c,D):_ in l&&(c=a(()=>M(D)),r.set(_+"",c))}if(v===void 0)(!h||(A=qt(l,o))!=null&&A.writable)&&(v=a(()=>M(void 0)),$(v,wt(u)),r.set(o,v));else{h=v.v!==D;var g=a(()=>wt(u));$(v,g)}var m=Reflect.getOwnPropertyDescriptor(l,o);if(m!=null&&m.set&&m.set.call(f,u),!h){if(n&&typeof o=="string"){var S=r.get("length"),T=Number(o);Number.isInteger(T)&&T>=S.v&&$(S,T+1)}De(s)}return!0},ownKeys(l){I(s);var o=Reflect.ownKeys(l).filter(v=>{var h=r.get(v);return h===void 0||h.v!==D});for(var[u,f]of r)f.v!==D&&!(u in l)&&o.push(u);return o},setPrototypeOf(){Wn()}})}var $t,rn,nn,sn;function vs(){if($t===void 0){$t=window,rn=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;nn=qt(e,"firstChild").get,sn=qt(e,"nextSibling").get,Ar(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Ar(r)&&(r.__t=void 0)}}function ne(t=""){return document.createTextNode(t)}function lr(t){return nn.call(t)}function Ne(t){return sn.call(t)}function Pe(t,e){return lr(t)}function hs(t,e){{var r=lr(t);return r instanceof Comment&&r.data===""?Ne(r):r}}function ds(t,e=1,r=!1){let n=t;for(;e--;)n=Ne(n);return n}function ps(t){t.textContent=""}function an(){return!1}function on(t){y===null&&w===null&&jn(),w!==null&&(w.f&K)!==0&&y===null&&Fn(),Rt&&Bn()}function gs(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function ut(t,e,r,n=!0){var s=y;s!==null&&(s.f&W)!==0&&(t|=W);var i={ctx:R,deps:null,nodes_start:null,nodes_end:null,f:t|B,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{Ut(i),i.f|=Je}catch(o){throw z(i),o}else e!==null&&at(i);var a=r&&i.deps===null&&i.first===null&&i.nodes_start===null&&i.teardown===null&&(i.f&er)===0;if(!a&&n&&(s!==null&&gs(i,s),w!==null&&(w.f&F)!==0)){var l=w;(l.effects??(l.effects=[])).push(i)}return i}function ms(t){const e=ut(ze,null,!1);return P(e,x),e.teardown=t,e}function Fe(t){on();var e=y.f,r=!w&&(e&tt)!==0&&(e&Je)===0;if(r){var n=R;(n.e??(n.e=[])).push(t)}else return ln(t)}function ln(t){return ut(Kr|rr,t,!1)}function ws(t){return on(),ut(ze|rr,t,!0)}function ys(t){he.ensure();const e=ut(Nt,t,!0);return(r={})=>new Promise(n=>{r.outro?ur(e,()=>{z(e),n(void 0)}):(z(e),n(void 0))})}function Es(t){return ut(nr|er,t,!0)}function Nr(t,e=[],r=[]){us(e,r,n=>{ut(ze,()=>t(...n.map(I)),!0)})}function un(t,e=0){var r=ut(te|e,t,!0);return r}function Ft(t,e=!0){return ut(tt,t,!0,e)}function fn(t){var e=t.teardown;if(e!==null){const r=Rt,n=w;Rr(!0),X(null);try{e.call(null)}finally{Rr(r),X(n)}}}function cn(t,e=!1){var s;var r=t.first;for(t.first=t.last=null;r!==null;){(s=r.ac)==null||s.abort(sr);var n=r.next;(r.f&Nt)!==0?r.parent=null:z(r,e),r=n}}function bs(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&tt)===0&&z(e),e=r}}function z(t,e=!0){var r=!1;(e||(t.f&Mn)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(ks(t.nodes_start,t.nodes_end),r=!0),cn(t,e&&!r),pe(t,0),P(t,It);var n=t.transitions;if(n!==null)for(const i of n)i.stop();fn(t);var s=t.parent;s!==null&&s.first!==null&&_n(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function ks(t,e){for(;t!==null;){var r=t===e?null:Ne(t);t.remove(),t=r}}function _n(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function ur(t,e){var r=[];fr(t,r,!0),vn(r,()=>{z(t),e&&e()})}function vn(t,e){var r=t.length;if(r>0){var n=()=>--r||e();for(var s of t)s.out(n)}else e()}function fr(t,e,r){if((t.f&W)===0){if(t.f^=W,t.transitions!==null)for(const a of t.transitions)(a.is_global||r)&&e.push(a);for(var n=t.first;n!==null;){var s=n.next,i=(n.f&tr)!==0||(n.f&tt)!==0;fr(n,e,i?r:!1),n=s}}}function cr(t){hn(t,!0)}function hn(t,e){if((t.f&W)!==0){t.f^=W,(t.f&x)===0&&(P(t,B),at(t));for(var r=t.first;r!==null;){var n=r.next,s=(r.f&tr)!==0||(r.f&tt)!==0;hn(r,s?e:!1),r=n}if(t.transitions!==null)for(const i of t.transitions)(i.is_global||e)&&i.in()}}let yt=!1;function Ir(t){yt=t}let Rt=!1;function Rr(t){Rt=t}let w=null,Y=!1;function X(t){w=t}let y=null;function ot(t){y=t}let q=null;function As(t){w!==null&&(q===null?q=[t]:q.push(t))}let C=null,U=0,G=null;function Ts(t){G=t}let de=1,jt=0,ht=jt;function Lr(t){ht=t}let it=!1;function dn(){return++de}function Ie(t){var v;var e=t.f;if((e&B)!==0)return!0;if((e&dt)!==0){var r=t.deps,n=(e&K)!==0;if(r!==null){var s,i,a=(e&ue)!==0,l=n&&y!==null&&!it,o=r.length;if((a||l)&&(y===null||(y.f&It)===0)){var u=t,f=u.parent;for(s=0;s<o;s++)i=r[s],(a||!((v=i==null?void 0:i.reactions)!=null&&v.includes(u)))&&(i.reactions??(i.reactions=[])).push(u);a&&(u.f^=ue),l&&f!==null&&(f.f&K)===0&&(u.f^=K)}for(s=0;s<o;s++)if(i=r[s],Ie(i)&&Zr(i),i.wv>t.wv)return!0}(!n||y!==null&&!it)&&P(t,x)}return!1}function pn(t,e,r=!0){var n=t.reactions;if(n!==null&&!(q!=null&&q.includes(t)))for(var s=0;s<n.length;s++){var i=n[s];(i.f&F)!==0?pn(i,e,!1):e===i&&(r?P(i,B):(i.f&x)!==0&&P(i,dt),at(i))}}function gn(t){var c;var e=C,r=U,n=G,s=w,i=it,a=q,l=R,o=Y,u=ht,f=t.f;C=null,U=0,G=null,it=(f&K)!==0&&(Y||!yt||w===null),w=(f&(tt|Nt))===0?t:null,q=null,fe(t.ctx),Y=!1,ht=++jt,t.ac!==null&&(t.ac.abort(sr),t.ac=null);try{t.f|=He;var v=(0,t.fn)(),h=t.deps;if(C!==null){var _;if(pe(t,U),h!==null&&U>0)for(h.length=U+C.length,_=0;_<C.length;_++)h[U+_]=C[_];else t.deps=h=C;if(!it||(f&F)!==0&&t.reactions!==null)for(_=U;_<h.length;_++)((c=h[_]).reactions??(c.reactions=[])).push(t)}else h!==null&&U<h.length&&(pe(t,U),h.length=U);if(re()&&G!==null&&!Y&&h!==null&&(t.f&(F|dt|B))===0)for(_=0;_<G.length;_++)pn(G[_],t);return s!==null&&s!==t&&(jt++,G!==null&&(n===null?n=G:n.push(...G))),(t.f&_t)!==0&&(t.f^=_t),v}catch(g){return ss(g)}finally{t.f^=He,C=e,U=r,G=n,w=s,it=i,q=a,fe(l),Y=o,ht=u}}function Ss(t,e){let r=e.reactions;if(r!==null){var n=xn.call(r,t);if(n!==-1){var s=r.length-1;s===0?r=e.reactions=null:(r[n]=r[s],r.pop())}}r===null&&(e.f&F)!==0&&(C===null||!C.includes(e))&&(P(e,dt),(e.f&(K|ue))===0&&(e.f^=ue),Xr(e),pe(e,0))}function pe(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)Ss(t,r[n])}function Ut(t){var e=t.f;if((e&It)===0){P(t,x);var r=y,n=yt;y=t,yt=!0;try{(e&te)!==0?bs(t):cn(t),fn(t);var s=gn(t);t.teardown=typeof s=="function"?s:null,t.wv=de;var i;kr&&es&&(t.f&B)!==0&&t.deps}finally{yt=n,y=r}}}function I(t){var e=t.f,r=(e&F)!==0;if(w!==null&&!Y){var n=y!==null&&(y.f&It)!==0;if(!n&&!(q!=null&&q.includes(t))){var s=w.deps;if((w.f&He)!==0)t.rv<jt&&(t.rv=jt,C===null&&s!==null&&s[U]===t?U++:C===null?C=[t]:(!it||!C.includes(t))&&C.push(t));else{(w.deps??(w.deps=[])).push(t);var i=t.reactions;i===null?t.reactions=[w]:i.includes(w)||i.push(w)}}}else if(r&&t.deps===null&&t.effects===null){var a=t,l=a.parent;l!==null&&(l.f&K)===0&&(a.f^=K)}if(Rt){if(vt.has(t))return vt.get(t);if(r){a=t;var o=a.v;return((a.f&x)!==0||mn(a))&&(o=or(a)),vt.set(a,o),o}}else if(r){if(a=t,st!=null&&st.has(a))return st.get(a);Ie(a)&&Zr(a)}if((t.f&_t)!==0)throw t.v;return t.v}function mn(t){if(t.v===D)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(vt.has(e)||(e.f&F)!==0&&mn(e))return!0;return!1}function wn(t){var e=Y;try{return Y=!0,t()}finally{Y=e}}const Ns=-7169;function P(t,e){t.f=t.f&Ns|e}function Is(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(Mt in t)je(t);else if(!Array.isArray(t))for(let e in t){const r=t[e];typeof r=="object"&&r&&Mt in r&&je(r)}}}function je(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let n in t)try{je(t[n],e)}catch{}const r=Ze(t);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const n=Hr(r);for(let s in n){const i=n[s].get;if(i)try{i.call(t)}catch{}}}}}const Rs=["touchstart","touchmove"];function Ls(t){return Rs.includes(t)}function Os(t){var e=w,r=y;X(null),ot(null);try{return t()}finally{X(e),ot(r)}}const yn=new Set,Ge=new Set;function xs(t,e,r,n={}){function s(i){if(n.capture||Ct.call(e,i),!i.cancelBubble)return Os(()=>r==null?void 0:r.call(this,i))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Yr(()=>{e.addEventListener(t,s,n)}):e.addEventListener(t,s,n),s}function Dt(t,e,r,n,s){var i={capture:n,passive:s},a=xs(t,e,r,i);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&ms(()=>{e.removeEventListener(t,a,i)})}function Ds(t){for(var e=0;e<t.length;e++)yn.add(t[e]);for(var r of Ge)r(t)}function Ct(t){var T;var e=this,r=e.ownerDocument,n=t.type,s=((T=t.composedPath)==null?void 0:T.call(t))||[],i=s[0]||t.target,a=0,l=t.__root;if(l){var o=s.indexOf(l);if(o!==-1&&(e===document||e===window)){t.__root=e;return}var u=s.indexOf(e);if(u===-1)return;o<=u&&(a=o)}if(i=s[a]||t.target,i!==e){$e(t,"currentTarget",{configurable:!0,get(){return i||r}});var f=w,v=y;X(null),ot(null);try{for(var h,_=[];i!==null;){var c=i.assignedSlot||i.parentNode||i.host||null;try{var g=i["__"+n];if(g!=null&&(!i.disabled||t.target===i))if(Ye(g)){var[m,...S]=g;m.apply(i,[t,...S])}else g.call(i,t)}catch(A){h?_.push(A):h=A}if(t.cancelBubble||c===e||c===null)break;i=c}if(h){for(let A of _)queueMicrotask(()=>{throw A});throw h}}finally{t.__root=e,delete t.currentTarget,X(f),ot(v)}}}function Ps(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function En(t,e){var r=y;r.nodes_start===null&&(r.nodes_start=t,r.nodes_end=e)}function _r(t,e){var r=(e&Zn)!==0,n,s=!t.startsWith("<!>");return()=>{n===void 0&&(n=Ps(s?t:"<!>"+t),n=lr(n));var i=r||rn?document.importNode(n,!0):n.cloneNode(!0);return En(i,i),i}}function Cs(){var t=document.createDocumentFragment(),e=document.createComment(""),r=ne();return t.append(e,r),En(e,r),t}function le(t,e){t!==null&&t.before(e)}function qs(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function Ms(t,e){return $s(t,e)}const gt=new Map;function $s(t,{target:e,anchor:r,props:n={},events:s,context:i,intro:a=!0}){vs();var l=new Set,o=v=>{for(var h=0;h<v.length;h++){var _=v[h];if(!l.has(_)){l.add(_);var c=Ls(_);e.addEventListener(_,Ct,{passive:c});var g=gt.get(_);g===void 0?(document.addEventListener(_,Ct,{passive:c}),gt.set(_,1)):gt.set(_,g+1)}}};o(Xe(yn)),Ge.add(o);var u=void 0,f=ys(()=>{var v=r??e.appendChild(ne());return Ft(()=>{if(i){Vr({});var h=R;h.c=i}s&&(n.$$events=s),u=t(v,n)||{},i&&Wr()}),()=>{var c;for(var h of l){e.removeEventListener(h,Ct);var _=gt.get(h);--_===0?(document.removeEventListener(h,Ct),gt.delete(h)):gt.set(h,_)}Ge.delete(o),v!==r&&((c=v.parentNode)==null||c.removeChild(v))}});return Us.set(u,f),u}let Us=new WeakMap;function Hs(t,e,r=!1){var n=t,s=null,i=null,a=D,l=r?tr:0,o=!1;const u=(_,c=!0)=>{o=!0,h(c,_)};var f=null;function v(){f!==null&&(f.lastChild.remove(),n.before(f),f=null);var _=a?s:i,c=a?i:s;_&&cr(_),c&&ur(c,()=>{a?i=null:s=null})}const h=(_,c)=>{if(a!==(a=_)){var g=an(),m=n;if(g&&(f=document.createDocumentFragment(),f.append(m=ne())),a?s??(s=c&&Ft(()=>c(m))):i??(i=c&&Ft(()=>c(m))),g){var S=H,T=a?s:i,A=a?i:s;T&&S.skipped_effects.delete(T),A&&S.skipped_effects.add(A),S.add_callback(v)}else v()}};un(()=>{o=!1,e(u),o||h(null,null)},l)}function Or(t,e){return e}function Ks(t,e,r){for(var n=t.items,s=[],i=e.length,a=0;a<i;a++)fr(e[a].e,s,!0);var l=i>0&&s.length===0&&r!==null;if(l){var o=r.parentNode;ps(o),o.append(r),n.clear(),Q(t,e[0].prev,e[i-1].next)}vn(s,()=>{for(var u=0;u<i;u++){var f=e[u];l||(n.delete(f.k),Q(t,f.prev,f.next)),z(f.e,!l)}})}function xr(t,e,r,n,s,i=null){var a=t,l={flags:e,items:new Map,first:null},o=(e&Fr)!==0;if(o){var u=t;a=u.appendChild(ne())}var f=null,v=!1,h=new Map,_=_e(()=>{var S=r();return Ye(S)?S:S==null?[]:Xe(S)}),c,g;function m(){Bs(g,c,l,h,a,s,e,n,r),i!==null&&(c.length===0?f?cr(f):f=Ft(()=>i(a)):f!==null&&ur(f,()=>{f=null}))}un(()=>{g??(g=y),c=I(_);var S=c.length;if(!(v&&S===0)){v=S===0;var T,A,N,b;if(an()){var E=new Set,k=H;for(A=0;A<S;A+=1){N=c[A],b=n(N,A);var O=l.items.get(b)??h.get(b);O?(e&(Te|Se))!==0&&bn(O,N,A,e):(T=kn(null,l,null,null,N,b,A,s,e,r,!0),h.set(b,T)),E.add(b)}for(const[ie,Re]of l.items)E.has(ie)||k.skipped_effects.add(Re.e);k.add_callback(m)}else m();I(_)}})}function Bs(t,e,r,n,s,i,a,l,o){var gr,mr,wr,yr;var u=(a&Yn)!==0,f=(a&(Te|Se))!==0,v=e.length,h=r.items,_=r.first,c=_,g,m=null,S,T=[],A=[],N,b,E,k;if(u)for(k=0;k<v;k+=1)N=e[k],b=l(N,k),E=h.get(b),E!==void 0&&((gr=E.a)==null||gr.measure(),(S??(S=new Set)).add(E));for(k=0;k<v;k+=1){if(N=e[k],b=l(N,k),E=h.get(b),E===void 0){var O=n.get(b);if(O!==void 0){n.delete(b),h.set(b,O);var ie=m?m.next:c;Q(r,m,O),Q(r,O,ie),Ce(O,ie,s),m=O}else{var Re=c?c.e.nodes_start:s;m=kn(Re,r,m,m===null?r.first:m.next,N,b,k,i,a,o)}h.set(b,m),T=[],A=[],c=m.next;continue}if(f&&bn(E,N,k,a),(E.e.f&W)!==0&&(cr(E.e),u&&((mr=E.a)==null||mr.unfix(),(S??(S=new Set)).delete(E))),E!==c){if(g!==void 0&&g.has(E)){if(T.length<A.length){var ae=A[0],et;m=ae.prev;var pr=T[0],Le=T[T.length-1];for(et=0;et<T.length;et+=1)Ce(T[et],ae,s);for(et=0;et<A.length;et+=1)g.delete(A[et]);Q(r,pr.prev,Le.next),Q(r,m,pr),Q(r,Le,ae),c=ae,m=Le,k-=1,T=[],A=[]}else g.delete(E),Ce(E,c,s),Q(r,E.prev,E.next),Q(r,E,m===null?r.first:m.next),Q(r,m,E),m=E;continue}for(T=[],A=[];c!==null&&c.k!==b;)(c.e.f&W)===0&&(g??(g=new Set)).add(c),A.push(c),c=c.next;if(c===null)continue;E=c}T.push(E),m=E,c=E.next}if(c!==null||g!==void 0){for(var Ot=g===void 0?[]:Xe(g);c!==null;)(c.e.f&W)===0&&Ot.push(c),c=c.next;var Oe=Ot.length;if(Oe>0){var In=(a&Fr)!==0&&v===0?s:null;if(u){for(k=0;k<Oe;k+=1)(wr=Ot[k].a)==null||wr.measure();for(k=0;k<Oe;k+=1)(yr=Ot[k].a)==null||yr.fix()}Ks(r,Ot,In)}}u&&Yr(()=>{var Er;if(S!==void 0)for(E of S)(Er=E.a)==null||Er.apply()}),t.first=r.first&&r.first.e,t.last=m&&m.e;for(var Rn of n.values())z(Rn.e);n.clear()}function bn(t,e,r,n){(n&Te)!==0&&Bt(t.v,e),(n&Se)!==0?Bt(t.i,r):t.i=r}function kn(t,e,r,n,s,i,a,l,o,u,f){var v=(o&Te)!==0,h=(o&Xn)===0,_=v?h?_s(s,!1,!1):Kt(s):s,c=(o&Se)===0?a:Kt(a),g={i:c,v:_,k:i,a:null,e:null,prev:r,next:n};try{if(t===null){var m=document.createDocumentFragment();m.append(t=ne())}return g.e=Ft(()=>l(t,_,c,u),Jn),g.e.prev=r&&r.e,g.e.next=n&&n.e,r===null?f||(e.first=g):(r.next=g,r.e.next=g.e),n!==null&&(n.prev=g,n.e.prev=g.e),g}finally{}}function Ce(t,e,r){for(var n=t.next?t.next.e.nodes_start:r,s=e?e.e.nodes_start:r,i=t.e.nodes_start;i!==null&&i!==n;){var a=Ne(i);s.before(i),i=a}}function Q(t,e,r){e===null?t.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}function An(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=An(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Fs(){for(var t,e,r=0,n="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=An(t))&&(n&&(n+=" "),n+=e);return n}function js(t){return typeof t=="object"?Fs(t):t??""}function Gs(t,e,r){var n=t==null?"":""+t;return n=n?n+" "+e:e,n===""?null:n}function Dr(t,e=!1){var r=e?" !important;":";",n="";for(var s in t){var i=t[s];i!=null&&i!==""&&(n+=" "+s+": "+i+r)}return n}function Vs(t,e){if(e){var r="",n,s;return Array.isArray(e)?(n=e[0],s=e[1]):n=e,n&&(r+=Dr(n)),s&&(r+=Dr(s,!0)),r=r.trim(),r===""?null:r}return String(t)}function Pr(t,e,r,n,s,i){var a=t.__className;if(a!==r||a===void 0){var l=Gs(r,n);l==null?t.removeAttribute("class"):t.className=l,t.__className=r}return i}function qe(t,e={},r,n){for(var s in r){var i=r[s];e[s]!==i&&(r[s]==null?t.style.removeProperty(s):t.style.setProperty(s,i,n))}}function Cr(t,e,r,n){var s=t.__style;if(s!==e){var i=Vs(e,n);i==null?t.removeAttribute("style"):t.style.cssText=i,t.__style=e}else n&&(Array.isArray(n)?(qe(t,r==null?void 0:r[0],n[0]),qe(t,r==null?void 0:r[1],n[1],"important")):qe(t,r,n));return n}const Ws=Symbol("is custom element"),Qs=Symbol("is html");function Me(t,e,r,n){var s=Ys(t);s[e]!==(s[e]=r)&&(e==="loading"&&(t[$n]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Xs(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Ys(t){return t.__attributes??(t.__attributes={[Ws]:t.nodeName.includes("-"),[Qs]:t.namespaceURI===zn})}var qr=new Map;function Xs(t){var e=qr.get(t.nodeName);if(e)return e;qr.set(t.nodeName,e=[]);for(var r,n=t,s=Element.prototype;s!==n;){r=Hr(n);for(var i in r)r[i].set&&e.push(i);n=Ze(n)}return e}function Zs(t=!1){const e=R,r=e.l.u;if(!r)return;let n=()=>Is(e.s);if(t){let s=0,i={};const a=ar(()=>{let l=!1;const o=e.s;for(const u in o)o[u]!==i[u]&&(i[u]=o[u],l=!0);return l&&s++,s});n=()=>I(a)}r.b.length&&ws(()=>{Mr(e,n),Ue(r.b)}),Fe(()=>{const s=wn(()=>r.m.map(Cn));return()=>{for(const i of s)typeof i=="function"&&i()}}),r.a.length&&Fe(()=>{Mr(e,n),Ue(r.a)})}function Mr(t,e){if(t.l.s)for(const r of t.l.s)I(r);e()}function zs(t){R===null&&Hn(),ee&&R.l!==null?Js(R).m.push(t):Fe(()=>{const e=wn(t);if(typeof e=="function")return e})}function Js(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const ti="5";var Ur;typeof window<"u"&&((Ur=window.__svelte??(window.__svelte={})).v??(Ur.v=new Set)).add(ti);rs();const ei=""+new URL("wp-DQGbDEnK.png",import.meta.url).href,ri=""+new URL("bp-B8GmcgS1.png",import.meta.url).href,ni=""+new URL("wk-DnKyhbMy.png",import.meta.url).href,si=""+new URL("bk-DHac7Iky.png",import.meta.url).href,ii=""+new URL("wq-B7vyKl2c.png",import.meta.url).href,ai=""+new URL("bq-CyE22i3P.png",import.meta.url).href,oi=""+new URL("wn-BTCLXZET.png",import.meta.url).href,li=""+new URL("bn-vssD0s4z.png",import.meta.url).href,ui=""+new URL("wr-B3Wwgo4H.png",import.meta.url).href,fi=""+new URL("br-B-YDt-tZ.png",import.meta.url).href,ci=""+new URL("wb-Cor4HfaI.png",import.meta.url).href,_i=""+new URL("bb-CFr3uo5J.png",import.meta.url).href,Tn="black",Et="white",mt=(t,e,r,n)=>({name:t,short:e,img:{black:r,white:n}}),vr={KING:mt("king","K",si,ni),QUEEN:mt("queen","Q",ai,ii),ROOK:mt("rook","R",fi,ui),BISHOP:mt("bishop","B",_i,ci),KNIGHT:mt("knight","N",li,oi),PAWN:mt("pawn","P",ri,ei)},lt=Object.fromEntries(Object.keys(vr).map(t=>[t,`${t}`])),Sn="jump",Lt="slide";class vi extends Error{}function hi(t){let e=t.charCodeAt(0)-97;if(e<0||e>8)throw hr(`letter=${t} is out of bounds`);return e>-1?e:0}function Nn(t){if(!/^[a-h][1-8]$/.test(t))throw hr(`dn=${t} is malformed`);let e=t.split(""),r=hi(e[0])+1,n=parseInt(e[1]);return[r,n]}function di(t){return Nn(t).join(",")}function bt(t){if(!/^[1-8],[1-8]$/.test(t))throw hr(`xy=${t} is malformed`);return" abcdefgh"[parseInt(t[0])]+t[2]}function hr(t){return new vi(t)}var Qt;class pt{constructor(e=lt.PAWN,r=Et){d(this,"piece_type",lt.PAWN);d(this,"colour",Et);d(this,"position","");d(this,"vector_type",Lt);d(this,"selected",!1);L(this,Qt,M(!1));this.piece_type=e,this.colour=r}get is_vulnerable(){return I(p(this,Qt))}set is_vulnerable(e){$(p(this,Qt),e,!0)}attack_squares(){throw new Error("Not implmemented for this generic Piece class")}toString(){const e=`${vr[this.piece_type].short}`;return this.colour==Et?e.toUpperCase():e.toLowerCase()}}Qt=new WeakMap,d(pt,"Vector");class pi extends pt{constructor(e){super(lt.PAWN,e),this.vector_type=Sn}attack_squares(){let[e,r]=this.position.split(",").map(s=>parseInt(s));return this.colour==Tn&&(r-=2),{"":[[e+1,r+1],[e-1,r+1]].flatMap(s=>se(...s)).filter(s=>!!s)}}}const ye=class ye extends pt{constructor(r){super(lt.ROOK,r);d(this,"_cls",ye);d(this,"Vector",this._cls.Vector);this.vector_type=Lt}new_vector(){return{forward:new Array,backward:new Array,left:new Array,right:new Array}}attack_squares(){const r=this.new_vector();let[n,s]=this.position.split(",").map(i=>parseInt(i));return[...Array(8).keys()].map(i=>i+1).forEach(i=>{let a=`${i},${s}`;i>n&&r.right.push(a),i<n&&r.left.unshift(a);let l=`${n},${i}`;i>s&&r.forward.push(l),i<s&&r.backward.unshift(l)}),r}};d(ye,"Vector");let ge=ye;const Ee=class Ee extends pt{constructor(r){super(lt.BISHOP,r);d(this,"_cls",Ee);d(this,"vector",this._cls.Vector);this.vector_type=Lt}new_vector(){return{ne:Array(),se:Array(),sw:Array(),nw:Array()}}attack_squares(){const r=this.new_vector(),[n,s]=this.position.split(",").map(i=>parseInt(i));return[...Array(8).keys()].map(i=>i+1).forEach(i=>{let a={ne:[n+i,s+i],se:[n-i,s+i],sw:[n-i,s-i],nw:[n+i,s-i]};Object.keys(r).forEach(l=>{const o=se(...a[l]);o&&r[l].push(o)})}),r}};d(Ee,"Vector");let me=Ee;class $r extends pt{constructor(e){super(lt.KNIGHT,e),this.vector_type=Sn}attack_squares(){let[e,r]=this.position.split(",").map(s=>parseInt(s));return{"":[[e+2,r-1],[e+2,r+1],[e-2,r-1],[e-2,r+1],[e-1,r+2],[e+1,r+2],[e-1,r-2],[e+1,r-2]].flatMap(s=>se(...s)).filter(s=>!!s)}}}const be=class be extends pt{constructor(r){super(lt.QUEEN,r);d(this,"_cls",be);d(this,"vector",this._cls.Vector);this.vector_type=Lt}new_vector(){return{n:Array(),ne:Array(),e:Array(),se:Array(),s:Array(),sw:Array(),w:Array(),nw:Array()}}attack_squares(){const r=this.new_vector(),[n,s]=this.position.split(",").map(i=>parseInt(i));return[...Array(8).keys()].map(i=>i+1).forEach(i=>{let a={n:[n,s+i],ne:[n+i,s+i],e:[n+i,s],se:[n+i,s-i],s:[n,s-i],sw:[n-i,s-i],w:[n-i,s],nw:[n-i,s+i]};Object.keys(r).forEach(l=>{const o=se(...a[l]);o&&r[l].push(o)})}),r}};d(be,"Vector");let Ve=be;const ke=class ke extends pt{constructor(r){super(lt.KING,r);d(this,"_cls",ke);d(this,"vector",this._cls.Vector);this.vector_type=Lt}new_vector(){return{n:Array(),ne:Array(),e:Array(),se:Array(),s:Array(),sw:Array(),w:Array(),nw:Array()}}attack_squares(){const r=this.new_vector(),[n,s]=this.position.split(",").map(l=>parseInt(l));let i=1,a={n:[n,s+i],ne:[n+i,s+i],e:[n+i,s],se:[n+i,s-i],s:[n,s-i],sw:[n-i,s-i],w:[n-i,s],nw:[n-i,s+i]};return Object.keys(r).forEach(l=>{const o=se(...a[l]);o&&r[l].push(o)}),r}};d(ke,"Vector");let We=ke;function se(t,e){return 1>t||t>8||1>e||e>8?null:`${t},${e}`}function kt(t){if(t==null||t==null)throw new Error("this typeguard should not be getting null");return(t==null?void 0:t.piece_type)!==void 0}var Yt,Xt,Zt;class gi{constructor(){L(this,Yt,M(0));L(this,Xt,M(0));L(this,Zt,M(0))}get mark_count(){return I(p(this,Yt))}set mark_count(e){$(p(this,Yt),e,!0)}get player_mark_count(){return I(p(this,Xt))}set player_mark_count(e){$(p(this,Xt),e,!0)}get opponent_mark_count(){return I(p(this,Zt))}set opponent_mark_count(e){$(p(this,Zt),e,!0)}mark_or_unmark(e,r=!1){r?this.mark_square(e):this.unmark_square(e)}mark_square(e){e==Et?this.player_mark_count+=1:this.opponent_mark_count+=1,this.mark_count++}unmark_square(e){e==Et?this.player_mark_count-=1:this.opponent_mark_count-=1,this.mark_count--}is_marked(){return this.mark_count>0}reset(){this.mark_count=0,this.player_mark_count=0,this.opponent_mark_count=0}toString(){return this.mark_count>0?"X":" "}}Yt=new WeakMap,Xt=new WeakMap,Zt=new WeakMap;var zt;class mi{constructor(){d(this,"_grid",new Map);d(this,"_selected_pieces",new Set);L(this,zt,M(wt({})));d(this,"WHITE_SIDE",this._side(Et));d(this,"BLACK_SIDE",this._side(Tn));const e=this._grid.set.bind(this._grid);this._grid.set=(r,n)=>(this.reactive_board[r]=n.toString(),e(r,n));for(let r=1;r<=8;r++)for(let n=1;n<=8;n++){let s,i=Math.max(r-1,0);switch(n){case 1:s=this.WHITE_SIDE[Object.keys(this.WHITE_SIDE)[i]];break;case 2:s=this.WHITE_SIDE.PAWNS[i];break;case 7:s=this.BLACK_SIDE.PAWNS[i];break;case 8:s=this.BLACK_SIDE[Object.keys(this.BLACK_SIDE)[i]];break;default:s=new gi;break}let a=`${r},${n}`;kt(s)&&(s.position=a),this._grid.set(a,s)}}get reactive_board(){return I(p(this,zt))}set reactive_board(e){$(p(this,zt),e,!0)}get get_grid(){return this._grid}move_piece(e,r){let n=Nn(r),s=`${n[0]},${n[1]}`,i=this._grid.get(s);if(kt(i))return;const a=Array.from(this._selected_pieces);a.forEach(u=>{this.toggle_attack_squares(u,!1)});let l=this._grid.get(s),o=e.position;this._grid.set(s,e),e.position=s,this._grid.set(o,l),l.reset(),a.forEach(u=>{this.toggle_attack_squares(u,!0)})}show_board(){console.log("-------------------------");for(let e=8;e>0;e--){let r="";for(let n=1;n<=8;n++)r+=this._grid.get(`${n},${e}`),r+=" ";console.log(r)}console.log("-------------------------")}get(e){let r=di(e),n=this._grid.get(r);if(n===void 0)throw new Error("Invalid square: "+e);return n}toggle_attack_squares(e,r=!1){const n=e.attack_squares();Object.keys(n).forEach(s=>{let i=!1;n[s].forEach(a=>{if(i)return;let l=bt(a),o=this.get(l);kt(o)?(o.colour!==e.colour&&(o.is_vulnerable=r),i=e.vector_type==Lt):o.mark_or_unmark(e.colour,r)})}),r?this._selected_pieces.add(e):this._selected_pieces.delete(e)}_side(e){return{ROOK_L:new ge(e),KNIGHT_L:new $r(e),BISHOP_L:new me(e),QUEEN:new Ve(e),KING:new We(e),BISHOP_R:new me(e),KNIGHT_R:new $r(e),ROOK_R:new ge(e),PAWNS:Array.from({length:8},r=>new pi(e))}}}zt=new WeakMap;const V={SELECTED:"selected",DRAGGING:"dragging",BLACK_SQUARE:"black",WHITE_SQUARE:"white",MARKED_SQAURE:"-marked",BOTH_MARKED_SQUARE:"-both",OPPONENT_SQUARE:"-opponent",VULNERABLE:"vulnerable"};var Jt;const Ht=class Ht{constructor(e){d(this,"DRAG_DELTA",30);L(this,Jt,M(()=>{}));d(this,"mouse_is_down",!1);d(this,"drag",!1);d(this,"drag_item",null);d(this,"drag_item_height",0);d(this,"drag_hover_cell",null);d(this,"g");d(this,"template_functions",Qe.get_instance());d(this,"empty_closure",()=>{});d(this,"reset_drag",()=>{this.drag_item&&(this.drag_item.classList.remove(V.DRAGGING),this.drag_item.style.removeProperty("left"),this.drag_item.style.removeProperty("top"),this.drag_item.style.removeProperty("height")),this.drag=!1,this.drag_item=null,this.drag_item_height=0,this.drag_hover_cell=null,this.mouse_move_listener=this.empty_closure,this.mouse_is_down=!1,console.debug("drag resetted")});d(this,"toggle_show_attack_squares",e=>{if(console.debug("toggle_show_attack_squares",e.currentTarget),e instanceof KeyboardEvent&&!["Enter"," "].includes(e.key))return;const r=e.currentTarget,n=r==null?void 0:r.querySelector("img"),s=r==null?void 0:r.parentElement;if(!r||!n||!s)throw new Error(`Can't find square for ${r}`);const i=bt(s.id),a=this.g.get(i);kt(a)&&(a.selected=!n.classList.contains(V.SELECTED),this.g.toggle_attack_squares(a,a.selected),a.selected?n.classList.add(V.SELECTED):n.classList.remove(V.SELECTED))});d(this,"_mouse_move_listener",e=>{var n;if(console.debug("_mouse_move_listener",e.currentTarget),this.drag&&this.drag_item&&this.mouse_is_down){this.drag_item.style.height=this.drag_item_height+"px",this.drag_item.style.left=e.x-this.drag_item_height/2+"px",this.drag_item.style.top=e.y-this.drag_item_height/2+"px",console.debug("moving dom");return}if(!this.drag_item){console.error(e.currentTarget);return}(n=this.drag_item.firstChild)!=null&&n.classList.contains(V.SELECTED)||!(e.offsetX>this.DRAG_DELTA||e.offsetY>this.DRAG_DELTA)||(this.drag_item_height=this.drag_item.getBoundingClientRect().height,this.drag_item.style.height=this.drag_item_height+"px",this.drag_item.classList.add(V.DRAGGING),this.drag=!0)});d(this,"mouse_down",e=>{console.debug("mouse down",e.currentTarget),!(e.button!=0||!e.currentTarget)&&(this.mouse_is_down=!0,this.drag_item=e.currentTarget,this.mouse_move_listener=this._mouse_move_listener)});d(this,"mouse_up",e=>{if(console.debug("mouse up",e.currentTarget),console.log(this.drag),this.drag&&this.drag_item&&this.drag_hover_cell){let r=bt(this.drag_item.parentElement.id),n=this.g.get(r);if(!kt(n)){console.error(n);return}r=bt(this.drag_hover_cell),this.g.move_piece(n,r),this.reset_drag();return}this.reset_drag()});d(this,"mouse_over",e=>{if(console.debug("mouse_over",e.currentTarget),!this.mouse_is_down||!e.currentTarget||!this.drag_item)return;const r=e.currentTarget;r.id!==this.drag_item.parentElement.id&&(this.drag_hover_cell=r.id)});d(this,"mouse_leave",e=>{console.debug("mouse_leave",e.currentTarget),this.drag&&(this.drag_hover_cell=null)});this.g=e}get mouse_move_listener(){return I(p(this,Jt))}set mouse_move_listener(e){$(p(this,Jt),e,!0)}static get_instance(e){return this.instance?this.instance:(this.instance=new Ht(e||new mi),this.instance)}onMount(){window.grid=Ht.get_instance().g}window_click(e){e.preventDefault()}r(e,r){return e}};Jt=new WeakMap,d(Ht,"instance");let we=Ht;const Ae=class Ae{constructor(){}static get_instance(){return this.instance?this.instance:(this.instance=new Ae,this.instance)}template_data(e,r){const n=we.get_instance(),s=`${r+1},${8-e}`,i=e&1^r&1?V.BLACK_SQUARE:V.WHITE_SQUARE,a=n.g.get(bt(n.r(s,n.g.reactive_board[s]))),l=kt(a)?a:null,o=l?null:a,f=o&&o.is_marked()?V.MARKED_SQAURE:"",v=o&&o.player_mark_count==0&&o.opponent_mark_count>0?V.OPPONENT_SQUARE:"",h=o&&o.player_mark_count>0&&o.opponent_mark_count>0?V.BOTH_MARKED_SQUARE:"",_=l!=null&&l.is_vulnerable?V.VULNERABLE:"",c=`cell ${i}${f}${v}${h}-cell ${_}`;return{piece:l,cell_class:c,empty:o}}};d(Ae,"instance");let Qe=Ae;var wi=_r('<div role="button" tabindex="0"><img draggable="false" class="svelte-1vtsfwy"/> <p class="svelte-1vtsfwy"></p></div>'),yi=_r('<div role="none"><!> <p class="svelte-1vtsfwy"> </p></div>'),Ei=_r('<div class="board svelte-1vtsfwy"></div>');function bi(t,e){Vr(e,!1);const r=we.get_instance();zs(r.onMount),Zs();var n=Ei();Dt("mousemove",$t,function(...s){var i;(i=r.mouse_move_listener)==null||i.apply(this,s)}),Dt("mouseup",$t,function(...s){var i;(i=r.mouse_up)==null||i.apply(this,s)}),Dt("click",$t,function(...s){var i;(i=r.window_click)==null||i.apply(this,s)}),Cr(n,"",{},{"background-color":"black"}),xr(n,4,()=>Array(8),Or,(s,i,a)=>{var l=Cs(),o=hs(l);xr(o,0,()=>Array(8),Or,(u,f,v,h)=>{var _=yi();const c=_e(()=>r.template_functions.template_data(a,v)),g=_e(()=>I(c).piece);Me(_,"id",`${v+1},${8-a}`),_.__mouseover=function(...N){var b;(b=r.mouse_over)==null||b.apply(this,N)};var m=Pe(_);{var S=N=>{var b=wi();b.__click=function(...k){var O;(O=r.toggle_show_attack_squares)==null||O.apply(this,k)},b.__keydown=function(...k){var O;(O=r.toggle_show_attack_squares)==null||O.apply(this,k)},b.__mousedown=function(...k){var O;(O=r.mouse_down)==null||O.apply(this,k)};var E=Pe(b);Nr(()=>{Pr(b,1,`piece ${I(g).colour??""}-piece`,"svelte-1vtsfwy"),Me(E,"alt",`${I(c).piece}`),Me(E,"src",vr[I(g).piece_type].img[I(g).colour])}),le(N,b)};Hs(m,N=>{I(g)&&N(S)})}var T=ds(m,2);Cr(T,"",{},{bottom:"0"});var A=Pe(T);Nr(N=>{Pr(_,1,js(I(c).cell_class),"svelte-1vtsfwy"),qs(A,N)},[()=>bt(`${v+1},${8-a}`)]),Dt("mouseleave",_,function(...N){var b;(b=r.mouse_leave)==null||b.apply(this,N)}),Dt("focus",_,function(...N){}),le(u,_)}),le(s,l)}),le(t,n),Wr()}Ds(["mouseover","click","keydown","mousedown"]);Ms(bi,{target:document.getElementById("app")});
